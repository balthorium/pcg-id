



Network Working Group                                           A. Biggs
Internet-Draft                                                 S. Cooley
Intended status: Standards Track                           Cisco Systems
Expires: January 4, 2016                                   July 03, 2015


            Primitives for Confidential Group Communications
        draft-abiggs-saag-primitives-for-confidential-groups-00

Abstract

   This specification defines generalized primitives for use in
   establishing end-to-end confidentiality in multiparty communications.
   These primitives address three essential elements of secure group
   communications: authentication, group membership, and secure key
   exchange.  A core objective of this specification is to define these
   primitives as common constructs for private group communications and
   in a manner that allows for flexibility in how they are integrated
   and deployed as part of new and existing group communications
   applications.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on January 4, 2016.

Copyright Notice

   Copyright (c) 2015 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect



Biggs & Cooley           Expires January 4, 2016                [Page 1]

Internet-Draprimitives-for-confidential-group-communications   July 2015


   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
     1.1.  Terminology . . . . . . . . . . . . . . . . . . . . . . .   3
     1.2.  Notational Conventions  . . . . . . . . . . . . . . . . .   4
   2.  Overview  . . . . . . . . . . . . . . . . . . . . . . . . . .   4
     2.1.  Authentication by Public Key Discovery  . . . . . . . . .   4
     2.2.  Authorization by Group Membership Block Chain . . . . . .   5
     2.3.  Key Distribution by Group Keys  . . . . . . . . . . . . .   6
   3.  Group Models  . . . . . . . . . . . . . . . . . . . . . . . .   7
     3.1.  Unmoderated Groups  . . . . . . . . . . . . . . . . . . .   8
     3.2.  Moderated Groups  . . . . . . . . . . . . . . . . . . . .   8
   4.  Security Considerations . . . . . . . . . . . . . . . . . . .   9
   5.  Appendix A. Document History  . . . . . . . . . . . . . . . .   9
   6.  Normative References  . . . . . . . . . . . . . . . . . . . .   9
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  10

1.  Introduction

   This specification defines application agnostic primitives for use in
   establishing authorization and end-to-end confidentiality in
   multiparty communications.  These primitives address three essential
   elements of secure group communications:

   o  Authentication

   o  Group Membership

   o  Secure Key Exchange

   Authentication is based on the identification of interoperating
   entities by acct URI and proof of possession of the private
   counterpart of a public key discoverable through a key discovery
   service [I-D.miller-saag-key-discovery] available from a well-known
   URL.

   Authorization is based on the group membership classification of
   authenticated entities, as represented in the form of a Group
   Membership Block Chain (GMBC) structure defined by this
   specification.  Critical properties of the GMBC are tamper-
   resistance, efficient mutability, broad deployability, and integrity
   in the context of distributed handling.




Biggs & Cooley           Expires January 4, 2016                [Page 2]

Internet-Draprimitives-for-confidential-group-communications   July 2015


   The secure exchange of keys is based on existing key wrapping
   standards which allow for the sharing of encrypted key material with
   multiple explicitly identified recipients.  This strategy builds on
   the GMBC based authorization model by taking advantage of reliable
   group membership classification when addressing wrapped keys to other
   members.

   A goal of this specification is to define these primitives in such a
   way as they may be suitable for both centralized and distributed
   management.  It is also a goal to describe these primitives in terms
   of accepted standards for cryptographic processing and
   infrastructure.

   A non-goal of this specification is to define the means by which
   these primitives are exchanged among interoperating entities involved
   in group communications.  Rather these are building blocks for
   extending group confidentiality to both new and existing
   communications and content sharing protocols.  With that in mind,
   however, this specification does advance the notion of recognizing
   two general classes of deployment for these primitives: "moderated"
   and "unmoderated".

   An additional non-goal of this specification is the establishment of
   mechanisms for the authentication of sender identity for encrypted
   data exchanged over a confidential group communications resource.
   Care is taken to ensure that only authenticated members of a group
   may decipher secured communications, however the means by which group
   members may reliably identify the originator of some particular
   communications data is out of scope for this specification.

1.1.  Terminology

   entity

      An entity is a user or automated agent that is uniquely
      identifiable by an acct URI [RFC7565] and for which there exists a
      key discovery service [I-D.miller-saag-key-discovery] through
      which public keys may be obtained for that URI.

   genesis block

      The first block in a group membership block chain.

   group

      A group is a set of entities whose membership wish to engage in
      secure and authenticated multiparty communications over some group
      communications resource.



Biggs & Cooley           Expires January 4, 2016                [Page 3]

Internet-Draprimitives-for-confidential-group-communications   July 2015


   group communications resource

      A group communications resource is any uniquely identifiable
      streamed or discrete data path that represents an exchange of
      personal communications between two or more entities.

   group key (GK)

      A group key is an encrypted object containing symmetric key
      material and associated metadata secured by the public key(s) of
      other group members.

   group membership block chain (GMBC)

      A group membership block chain is a primitive defined by this
      specification for the purpose of providing an effective means for
      defining, updating, sharing, and verifying the membership of a
      group.

   This document uses the terminology from [RFC7515], [RFC7516],
   [RFC7517], and [RFC7518] when discussing JOSE technologies.  Most
   security-related terms in this document are to be understood in the
   sense defined in [RFC4949].

1.2.  Notational Conventions

   In this document, the key words "MUST", "MUST NOT", "REQUIRED",
   "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
   and "OPTIONAL" are to be interpreted as described in BCP 14, RFC 2119
   [RFC2119].

2.  Overview

   This section provides a general overview of three basic constructs
   for enabling authentication, authorization, and secure key exchange
   in confidential group communications.

2.1.  Authentication by Public Key Discovery

   In the context of this specification, entity authentication is
   defined as the demonstration of possession of the private component
   of an asymmetric key pair.  Specifically, an entity uniquely
   identified by an acct URI [RFC7565] may be authenticated by
   demonstrating possession of the private counterpart of one or more
   public keys as may be discovered using that acct URI and the
   mechanisms described in [I-D.miller-saag-key-discovery].





Biggs & Cooley           Expires January 4, 2016                [Page 4]

Internet-Draprimitives-for-confidential-group-communications   July 2015


2.2.  Authorization by Group Membership Block Chain

   In the context of this specification, authorization is defined as the
   classification of any given entity as either a "member" or "non-
   member" with respect to a group.  A member of the group is by
   definition authorized to receive keying material used to encrypt
   group communications, and likewise a non-member is not.  A member is
   also entitled to alter the membership of the group.  The means by
   which group membership classification established, updated, and
   validated is through operations on a Group Membership Block Chain
   (GMBC).

   A GMBC is an ordered list of data blocks representing a tamper-
   resistant chronological account of group membership updates.  The
   first block in the GMBC defines the initial set of group members and
   each subsequent block represents an addition/removal of one or more
   other entities to/from the group.  Any entity can create a GMBC, but
   only members can update it by appending new blocks.

   Each block consists of a JSON object signed (as a JWS [RFC7515]) with
   the private key of the entity that created that block within the
   chain.  That JSON object includes attributes representing the
   following:

   o  the acct URI [RFC7565] of the entity that created the block,

   o  an array of group membership update operations,

   o  a timestamp indicating the date and time of the block's creation,
      and

   o  a hash of the preceding block in the membership chain (if any).

   A group membership update operation is a JSON object with two fields:

   o  a tag indicating the operation type ("add" or "remove"), and

   o  the acct URI of the entity being either added to or removed from
      the group.

   In addition to the above attributes the first block of the chain, or
   genesis block, also includes the following attributes:

   o  a URI that uniquely identifies the group communications resource,

   o  the acct URI [RFC7565] of the group moderator (optional), and

   o  a nonce.



Biggs & Cooley           Expires January 4, 2016                [Page 5]

Internet-Draprimitives-for-confidential-group-communications   July 2015


   The genesis block must also include at least one "add" operation,
   though it need not necessarily represent the addition of the entity
   that created it (i.e. entities may create new groups within which
   they are not themselves members).

   The membership of the group is implicit and may be determined by
   processing the GMBC in chronological order.  At any given point in
   time the membership of the group is defined as that set of entities
   for which there exists, for each entity, a previously introduced
   block containing an "add" operation for which there does not exist a
   subsequent but also previously introduced block containing a "remove"
   operation.

   To protect against unauthorized tampering the GMBC is validated by
   verifying the signatures of each block, verifying that each non-
   genesis block contains a valid hash of the preceding block, and
   verifying that each block is created by an entity that is among the
   group's membership as determined by the segment of chain preceding
   that block.  Block signature verification is made possible through
   the key discovery mechanisms defined in
   [I-D.miller-saag-key-discovery] and the knowledge of each member's
   acct URI [RFC7565].

2.3.  Key Distribution by Group Keys

   A Group Key (GK) is signed object containing encrypted symmetric key
   material with associated metadata.  A GK exists for the purpose of
   sharing the contained symmetric key with other members of the group.
   The exclusivity of access to the key material is achieved by
   encrypting the key material in such a way that it may be decrypted
   with the private entity key(s) of any one of the other group members.
   The creating entity signs the GK such that the authenticity of the
   associated metadata may be verified by its recipients.

   More specifically, the payload of the GK is a JSON object including
   attributes representing the following:

   o  a URI that uniquely identifies the GK,

   o  the acct URI [RFC7565] of the creator of the GK,

   o  a hash of the GMBC tail block at the time this key was created,

   o  an encrypted JWK [RFC7517] that represents the symmetric key
      material, and

   o  a timestamp indicating a time beyond which the key should not be
      used for encryption.



Biggs & Cooley           Expires January 4, 2016                [Page 6]

Internet-Draprimitives-for-confidential-group-communications   July 2015


   The JWK attribute value is encrypted in a JWE [RFC7516] JSON
   serialization with one or more recipients.  In unmoderated groups the
   resulting JSON serialization must include each other member of the
   group as determined by the current and validated GMBC.  In moderated
   groups the resulting JSON serialization may include as a recipient
   just the moderator (e.g. when an entity shares a new GK) or just one
   member (e.g. when the moderator shares a GK with a member that has
   requested it).  The full JSON payload of the GK is signed as a JWS
   [RFC7515] using the creator's private entity key.

   GKs may be created by members and non-members alike.  A non-member
   may generate a GK as described above and use it to encrypt its own
   communications to the group.  This can be a useful property as it
   provides for a confidential "write only" capability to the group
   communications resource.

   A group may have any number of GKs associated with it.  Each member
   of a group must use its own GK for purposes of encryption and shares
   this GK with the remainder of the group for purposes of decryption.
   A member should not re-use a GK provided by another entity as that
   other entity may not necessarily be a member.

   Upon receiving and validating an update to the GMBC that includes
   "remove" operations, each entity must discard their encryption GK and
   produce a new encryption GK for which the recipients reflect the
   updated GMBC membership.  This is necessary to ensure that new
   members are able to decrypt subsequent communications but not prior
   communications.  Perhaps more importantly, this also ensures that
   former members are not able to decrypt subsequent group
   communications.  In moderated groups the moderator may implement a
   policy where it permits new group members to request previously
   created GKs.

   It is recommended that all entities that share encrypted content over
   the group communications resource rotate their GKs regularly so as to
   mitigate against vulnerabilities that are exacerbated by the extended
   use of individual keys.

3.  Group Models

   While this specification provides definition for constructs that
   enable confidential group communications, the means by which these
   objects may be exchanged among group members is intentionally omitted
   as this is regarded as out of scope for this specification.  It
   remains worthwhile, however, to discuss two general classes of
   confidential group communications and how the primitives defined by
   this specification may be leveraged in each.  These classes may be
   described as "moderated groups" and "unmoderated groups".



Biggs & Cooley           Expires January 4, 2016                [Page 7]

Internet-Draprimitives-for-confidential-group-communications   July 2015


3.1.  Unmoderated Groups

   An unmoderated group is characterized by the absence of a moderator
   attribute in the GMBC genesis block and therefore the absence of a
   permanent member within the group through which GMBC and GK objects
   may be exchanged.  In an unmoderated group these objects may instead
   be exchanged either in-band through the group communications resource
   itself, or through in-band references to external repositories within
   which GMBC and GK objects are stored.  Both the GMBC and GK objects
   are designed to be hardened against tampering and protect sensitive
   data such that they may be reasonably exchanged through either public
   or private transports and stores.

3.2.  Moderated Groups

   A moderated group is characterized by the presence of a moderator
   attribute in the GMBC genesis block.  The moderator attribute
   identifies an entity by its acct URI [RFC7565] and declares that
   entity as a permanent member of the group which will serve as a
   facilitator for the exchange of GMBC and GK objects among all group
   members.  In particular, a moderator will respond to the following
   types of requests from other entities.  Note that the means by which
   these operations are carried out between members and the moderator is
   out of scope for this document.

   GMBC Post

      When adding or removing members from a group, a member will submit
      a new GMBC block to the moderator representing that change.  The
      moderator will verify that the block is signed by a member of the
      group and that the hash attribute of the block represents the hash
      of the current tail end of the chain.  If both checks succeed then
      the moderator will make the new block a permanent part of the GMBC
      and indicate to the requesting entity that the update was
      successful.

   GMBC Get

      Entities may request all or part of the current GMBC from the
      moderator by providing to the GMBC a hash of the last GMBC block
      of which they are aware (or 0x0 if they are requesting the entire
      chain).

   GMBC Notify (optional)

      In some deployments it may be desirable for a moderator to
      immediately multicast GMBC updates to all current members of the




Biggs & Cooley           Expires January 4, 2016                [Page 8]

Internet-Draprimitives-for-confidential-group-communications   July 2015


      group.  This may be based on either an explicit or automatic/
      implicit subscription model.

   GK Post

      Entities may inform the moderator of new GKs which they have
      generated for the purpose of encrypting data they emit to the
      group communications resource.  The moderator will store a
      received GKs such that it may subsequently service requests for
      that GK from other members that wish to decrypt these
      communications.

   GK Get

      Members may request from the moderator GKs which have been
      generated by other entities.  In doing so, an entity must indicate
      the URI of the requested GK and the moderator must verify that the
      requesting entity was a member of the group at the time the GK was
      created by processing the GMBC from the genesis block up to and
      including the block whose hash is indicated in the metadata of the
      requested GK.  A successful confirmation of the requesting entity
      as a member of the group at that point in time will result in the
      moderator generating a new GK which is in every way identical to
      the requested GK except that the key material is re-encrypted
      using the public key of the requesting entity and the GK itself is
      signed using the moderator's own public entity key.

4.  Security Considerations

   Security considerations are discussed throughout this document.
   Additional considerations may be added here as needed.

5.  Appendix A.  Document History

   -00

   o  Initial draft.

6.  Normative References

   [I-D.miller-saag-key-discovery]
              Miller, M. and S. Nandakumar, "Key Discovery Service",
              draft-miller-saag-key-discovery-00 (work in progress),
              July 2015.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.




Biggs & Cooley           Expires January 4, 2016                [Page 9]

Internet-Draprimitives-for-confidential-group-communications   July 2015


   [RFC4949]  Shirey, R., "Internet Security Glossary, Version 2", RFC
              4949, August 2007.

   [RFC7515]  Jones, M., Bradley, J., and N. Sakimura, "JSON Web
              Signature (JWS)", RFC 7515, May 2015.

   [RFC7516]  Jones, M. and J. Hildebrand, "JSON Web Encryption (JWE)",
              RFC 7516, May 2015.

   [RFC7517]  Jones, M., "JSON Web Key (JWK)", RFC 7517, May 2015.

   [RFC7518]  Jones, M., "JSON Web Algorithms (JWA)", RFC 7518, May
              2015.

   [RFC7565]  Saint-Andre, P., "The 'acct' URI Scheme", RFC 7565, May
              2015.

Authors' Addresses

   Andrew Biggs
   Cisco Systems

   Email: adb@cisco.com


   Shaun Cooley
   Cisco Systems

   Email: shcooley@cisco.com






















Biggs & Cooley           Expires January 4, 2016               [Page 10]
